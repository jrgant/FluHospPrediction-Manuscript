---
title: "Supplement to: Predicting seasonal influenza hospitalization using an ensemble super learner: a simulation study"

bibliography: references.bib
csl: american-journal-of-epidemiology.csl

always_allow_html: true
---

Jason R. Gantenberg,(1,2) Kevin W. McConeghy,(2,3) Chanelle J. Howe,(4) Jon Steingrimsson,(5) Robertus van Aalst,(6,7), Ayman Chit,(6,8), Andrew R. Zullo(1,2,3)

1. Department of Epidemiology, Brown University School of Public Health, 121 S. Main St., Providence, RI, 02912

1. Department of Health Services, Policy and Practice, 121 S. Main St., Providence, RI, 02912

1. Providence VA Medical Center, 830 Chalkstone Ave., Providence, RI, 02908

1. Center for Epidemiology and Environmental Health, Brown University School of Public Health, 121 S. Main St., Providence, RI, 02912

1. Department of Biostatistics, Brown University School of Public Health, 121 S. Main St., Providence, RI 02912

1. Sanofi Pasteur, Swiftwater, PA 18370

1. Department of Health Sciences, University of Groningen, University Medical Center Groningen, Groningen, the Netherlands

1. Leslie Dan Faculty of Pharmacy, University of Toronto, Canada

**Corresponding author:** Jason R. Gantenberg (jrgant@brown.edu)
\newpage

```{r include = FALSE}
source("manuscript-setup.R")
```
# Emerging Infections Program

The EIP contains data on influenza-related hospitalizations in California, Colorado, Connecticut, Georgia, Maryland, Minnesota, New Mexico, New York, Oregon, and Tennessee [@Centers_for_Disease_Control_and_Prevention_undated-vt]. Since the 2009--2010 season the FluSurv Network has included between 3 and 6 states in addition to those represented in the EIP data, depending on the year [@Centers_for_Disease_Control_and_Prevention_undated-vt]. To maintain consistency within the empirical data, and to maximize the number of flu seasons available to inform curve simulation, we excluded data from states outside the EIP.

Influenza hospitalization cases reflect individuals hospitalized during the flu season and for whom infection control logs and/or hospital laboratory or admissions data indicated a positive test for influenza [@Centers_for_Disease_Control_and_Prevention_undated-vt]. According to the CDC, a hospitalization's being identified as related to influenza depends upon laboratory tests ordered at the discretion of a physician, suggesting that surveillance statistics probably underestimate the true burden of influenza hospitalization [@Centers_for_Disease_Control_and_Prevention_undated-vt]. Typically, the CDC releases influenza hospitalization data for epiweeks 40--53 and 1--17, corresponding approximately to October through April of the next year [@Centers_for_Disease_Control_and_Prevention_undated-vt; @Centers_for_Disease_Control_and_Prevention_undated-pu]. Epiweeks are integers assigned to each week (beginning on Sunday) of the calendar year, where epiweek 1 is the first week of the calendar year and epiweeks 52/53 the last, depending on leap years [@Centers_for_Disease_Control_and_Prevention_undated-pu]. We renumbered epiweeks falling within the range of influenza hospitalization data as 1--30, omitting epiweek 53, which was present in only 3 of the 15 available empirical seasons. Hereafter we refer to this 30-week period generically as a _flu season_.

# Simulating influenza hospitalization curves

As discussed in the Methods, our curve simulation procedure is adapted from an approach developed by Brooks et al [@ @Brooks2015-fl]. The original curve-generating function was developed to simulate potential ILI curves and, consequently, included a term for season-onset, representing the threshold ILI at which the flu season would be considered to have started [@Brooks2015-fl]. This onset is an additional prediction target in FluSight ILI forecasting because ILI surveillance is conducted year-round. However, such a threshold does not exist for influenza-related hospitalizations because hospitalization rates are recorded starting in epiweek 40 through the end of the flu season and (save for one season) begin at a rate of 0 per 100,000 [@Centers_for_Disease_Control_and_Prevention_undated-vt]. We modified the curve-generating function to omit the seasonal onset term and added a transformation to constrain simulated hospitalization rates to be at least 0. Otherwise, the implementation closely followed the Brooks et al. approach.

For each simulated curve, each of the following parameters is sampled randomly and independently of one another:

$$\langle f, \sigma, \nu, \theta, \mu \rangle,$$

where:

- $f$ denotes a randomly selected vector of estimated hospitalization rates based on a linear trend filter fit to empirical season $s$, 
- $\sigma$ denotes the root mean squared error of a linear trend filter fit to randomly sampled shape template $s'$ and averaged across all weeks, 
- $\nu$ denotes a random draw from the continuous uniform distribution [0.75, 1.25], 
- $\theta$ denotes a random draw from a continuous uniform distribution bounded by the minimum and maximum peak hospitalization rates from the 15 trend filter fits, and 
- $\mu$ denotes a random draw from a continuous uniform distribution bounded by the minimum and maximum peak weeks based on the 15 trend filter fits.

The generating function for the hospitalization rate in week $i$ of simulated season $sim$ is therefore given by:

```{r, results = "asis", echo = FALSE}

cat("$$f^{sim} (i) = \\frac{\\theta}{\\text{max}_j f(j)} \\left[ f \\left( \\frac{i - \\mu}{v} + \\substack{\\text{arg max }{j} \\\\ f(j) } \\right) \\right] + \\epsilon_i, \\epsilon_i \\sim N(0, (\\hat{\\tau}^{s'})^2),$$")

```

where $f(j)$ now denotes the vector of fitted hospitalization rates from the linear trend filter fit (randomly selected shape $f$) and $j$ the integer week for which we want to retrieve the prediction from this fit (where the prediction will be assigned to week $i$ in the final curve). $max_j f(j)$ denotes the peak hospitalization rate from the selected shape, whereas `r  "$\\substack{\\text{arg max }{j} \\\\ f(j) }$"` denotes the week in which this peak occurred. The parameters $\theta$, $\mu$, and $\nu$ follow from their prior description. Finally, we introduce noise for each simulated weekly hospitalization rate based on the selected estimate of $\tau^2$.

The formula above conceals a minor alteration we made in order to retrieve predictions for week *j*. The `genlasso` package requires an identity predictor matrix for fitting the trend filter and selecting its $\lambda$ penalty [@Arnold-2019-gl]. In order to generate predictions for week *j* from the trend filter models, where *j* is a perturbed version of *i*, we translated *j* to indicate the proportion by which to increase or decrease the predicted hospitalization rate for a given week. For instance, say $j = 5.5$ and will be mapped to week $i = 6$ in the simulated curve. The predictor matrix fed to the model in order to get the prediction for *j* would have the value 0.917 in row 6, column 6.


# Component models

## Linear regression

For each week of the flu season, we specified a linear regression model that included covariates chosen by a correlation-based screening algorithm [@Friedman2019-uw; @Polley2019-sl] in which covariates with _p_ < 0.10 were entered into the linear regression. The linear model was specified using the `glm()` function in R with a Gaussian error distribution and identity link.

## Penalized regression

We implemented several loss-based regression learners using the `glmnet` package in R [@Friedman2019-uw]. These learners included a learner with the lasso penalty [@Tibshirani1996-vt], a learner with the ridge penalty [@Tibshirani1996-vt], and three versions of the elastic net model [@Friedman2019-uw] using different $\alpha$ penalties. The elastic net model essentially combines elements of the lasso and ridge penalties within the same model [@Friedman2019-uw]. All models selected their respective $\lambda$ penalties via 10-fold cross-validation (according to package defaults) and used a Gaussian error distribution [@Friedman2019-uw]. We also activated the option to standardize covariates for the lasso and ridge models [@Friedman2019-uw]. The elastic net model essentially combines elements of the lasso and ridge penalties within the same model [@Friedman2019-uw].

## Random forests

We implemented random forest algorithms [@Breiman2001-vm] using the `randomForest` package [@Liaw2018-fe]. We modified tuning parameters governing the number of regression trees grown (i.e., the size of the forest), the  minimum number of observations allowed in terminal nodes, and the number of covariates selected for splitting in each tree.

## Support vector regression

We implemented several support vector regressions [@Hastie2009-ft] using the `e1071` package [@Meyer2019-gr]---one using a radial kernel and three others using a polynomial kernel of differing degrees.

## Neural networks

We implemented several neural networks [@Hastie2009-ft] using the `nnet` package [@Ripley2020-ds]. All learners proposed contained a single hidden layer, altering tuning parameters governing the number of nodes in this hidden layer and the magnitude of decay applied to node weights.

## LOESS

We submitted several LOESS-based learners as implemented in base R, varying the smoothing kernel span. 

## Polynomial multivariate adaptive regression splines

We submitted several polyMARS models using the `polspline` package [@Kooperberg2019-ma], varying the generalized cross-validation value, larger values of which produce smaller models [@Kooperberg2019-ma].


# Accounting for dependence

To account for the lack of independence between curves, we assigned all simulated curves based on the same empirical season shape to the same fold (e.g., all curves based on the trend filter fit to season 2004-05). We did not account for potential dependencies due to repeated sampling of the noise term, as we believed the season shape was more consequential with respect to inducing dependence between simulated curves. For one, the noise injected into the simulated curves was typically very small. In addition, the season shape is the strongest determinant of how the simulated hospitalization curve changes over time.

# Technical details

The super learner algorithm was implemented on a high-performance computing cluster housed at the Center for Computation and Visualization at Brown University. Each run was submitted to a large-memory node and parallelized across 32 central processing units using functionality provided in `sl3` [@Coyle2020-ze] via the `delayed` [@Coyle2020-rq] and `future` [@Bengtsson2020-oz] packages in R. In general, running the super learner algorithm required between (roughly) 30--60 minutes per week across all prediction targets, with approximately 22--24 hours required to conduct a complete set of computing jobs for a single prediction target. 

# Ethics statement

This manuscript involves only the use of publicly available influenza surveillance data aggregated at the national level. Therefore, the study is not considered Human Subjects Research and no Institutional Review Board approval was required.

# Results

## Alternate trend filter penalty

```{r sen-l1se-setup}
pkrate_risks_1se <- fread(get_asset("TAB", "Risks-EDSL-Mean_PeakRate-L1SE"))
presl_num_1se <- get_risks(pkrate_risks_1se, "SuperLearner")
prdsl_num_1se <- get_risks(pkrate_risks_1se, "DiscreteSL")

pkweek_risks_1se <- fread(get_asset("TAB", "Risks-EDSL-Mean_PeakWeek-L1SE"))
pwesl_num_1se <- get_risks(pkweek_risks_1se, "SuperLearner")
pwdsl_num_1se <- get_risks(pkweek_risks_1se, "DiscreteSL")

cumhosp_risks_1se <- fread(get_asset("TAB", "Risks-EDSL-Mean_CumHosp-L1SE"))
chesl_num_1se <- get_risks(cumhosp_risks_1se, "SuperLearner")
chdsl_num_1se <- get_risks(cumhosp_risks_1se, "DiscreteSL")
```

For the peak rate prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(presl_num_1se)` and `r max(presl_num_1se)` per 100,000 population and the discrete super learner's between `r min(prdsl_num_1se)` and `r max(presl_num_1se)` per 100,000 population. For the peak week prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(pwesl_num_1se)` and `r max(pwesl_num_1se)` weeks and the discrete super learner's between `r min(pwdsl_num_1se)` and `r max(pwdsl_num_1se)` weeks. For the cumulative hospitalization prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(chesl_num_1se)` and `r max(chesl_num_1se)` per 100,000 population and the discrete super learner's ranged between `r min(chdsl_num_1se)` and `r max(chdsl_num_1se)` per 100,000 population.

## Component learner subset

```{r sen-erf-setup}
pkrate_risks_erf <- fread(get_asset("TAB", "Risks-EDSL-Mean_PeakRate-ERF"))
presl_num_erf <- get_risks(pkrate_risks_erf, "SuperLearner")
prdsl_num_erf <- get_risks(pkrate_risks_erf, "DiscreteSL")

pkweek_risks_erf <- fread(get_asset("TAB", "Risks-EDSL-Mean_PeakWeek-ERF"))
pwesl_num_erf <- get_risks(pkweek_risks_erf, "SuperLearner")
pwdsl_num_erf <- get_risks(pkweek_risks_erf, "DiscreteSL")

cumhosp_risks_erf <- fread(get_asset("TAB", "Risks-EDSL-Mean_CumHosp-ERF"))
chesl_num_erf <- get_risks(cumhosp_risks_erf, "SuperLearner")
chdsl_num_erf <- get_risks(cumhosp_risks_erf, "DiscreteSL")
```

For the peak rate prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(presl_num_erf)` and `r max(presl_num_erf)` per 100,000 population and the discrete super learner's between `r min(prdsl_num_erf)` and `r max(presl_num_erf)` per 100,000 population. For the peak week prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(pwesl_num_erf)` and `r max(pwesl_num_erf)` weeks and the discrete super learner's between `r min(pwdsl_num_erf)` and `r max(pwdsl_num_erf)` weeks. For the cumulative hospitalization prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(chesl_num_erf)` and `r max(chesl_num_erf)` per 100,000 population and the discrete super learner's between `r min(chdsl_num_erf)` and `r max(chdsl_num_erf)` per 100,000 population.

## Squared error loss

```{r sen-sqe-setup}
pkrate_risks_sqe <- fread(get_asset("TAB", "Risks-EDSL-Mean_PeakRate-SQE"))
presl_num_sqe <- get_risks(pkrate_risks_sqe, "SuperLearner")
prdsl_num_sqe <- get_risks(pkrate_risks_sqe, "DiscreteSL")

pkweek_risks_sqe <- fread(get_asset("TAB", "Risks-EDSL-Mean_PeakWeek-SQE"))
pwesl_num_sqe <- get_risks(pkweek_risks_sqe, "SuperLearner")
pwdsl_num_sqe <- get_risks(pkweek_risks_sqe, "DiscreteSL")

cumhosp_risks_sqe <- fread(get_asset("TAB", "Risks-EDSL-Mean_CumHosp-SQE"))
chesl_num_sqe <- get_risks(cumhosp_risks_sqe, "SuperLearner")
chdsl_num_sqe <- get_risks(cumhosp_risks_sqe, "DiscreteSL")
```

For the peak rate prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(presl_num_sqe)` and `r max(presl_num_sqe)` per 100,000 population and the discrete super learner's between `r min(prdsl_num_sqe)` and `r max(presl_num_sqe)` per 100,000 population. For the peak week prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(pwesl_num_sqe)` and `r max(pwesl_num_sqe)` weeks and the discrete super learner's between `r min(pwdsl_num_sqe)` and `r max(pwdsl_num_sqe)` weeks. For the cumulative hospitalization prediction target, the ensemble super learner's predictions exhibited mean prediction risks ranging between `r min(chesl_num_sqe)` and `r max(chesl_num_sqe)` per 100,000 population and the discrete super learner's between `r min(chdsl_num_sqe)` and `r max(chdsl_num_sqe)` per 100,000 population.


\newpage 
# Supplemental Tables and Figures

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-tf-pred-lmin, results = "asis", fig.asp = 1800/2250}
slug <- "TF-Predictions_lambda.min"
supp_cap(slug)
include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-simtemplate-counts, results = "asis"}
slug <- "Simulation-Template-Counts"
tmpcts <- fread(get_asset("TAB", slug))

supp_cap(slug)

tmpcts %>%
  flextable %>%
  bold(part = "header") %>%
  theme_booktabs() %>%
  font(., fontname = global_table_font, part = "all") %>%
  autofit
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakrate-meanrisk, results = "asis"}
slug <- "Risk-Week_Peak-Rate"
rpsum <- fread(get_asset("TAB", slug))

supp_cap(slug)

rpsum %>%
  flextable(cwidth = c(0.6, rep(1.15, 5))) %>%
  colformat_num(
    j = 2:6,
    digits = 2
  ) %>%
  bold(., part = "header") %>%
  padding(padding = 0, part = "all") %>%
  font(., fontname = global_table_font, part = "all")

```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakweek-meanrisk, results = "asis"}
slug <- "Risk-Week_Peak-Week"
rwsum <- fread(get_asset("TAB", slug))

supp_cap(slug)

rwsum %>%
  flextable(cwidth = c(0.6, rep(1.15, 5))) %>%
  colformat_num(
    j = 2:6,
    digits = 2
  ) %>%
  bold(., part = "header") %>%
  padding(padding = 0, part = "all") %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-cumhosp-meanrisk, results = "asis"}
slug <- "Risk-Week_Cum-Hosp"
rwsum <- fread(get_asset("TAB", slug))

supp_cap(slug)

rwsum %>%
  flextable(cwidth = c(0.6, rep(1.15, 5))) %>%
  colformat_num(
    j = 2:6,
    digits = 2
  ) %>%
  bold(., part = "header") %>%
  padding(padding = 0, part = "all") %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakrate-risktiles, results = "asis", fig.asp = 1950/3600}
slug <- "Risktiles_Peak-Rate"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakweek-risktiles, results = "asis", fig.asp = 1950/3600}
slug <- "Risktiles_Peak-Week"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-cumhosp-risktiles, results = "asis", fig.asp = 1950/3600}
slug <- "Risktiles_Cum-Hosp"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-tfpred-lse, results = "asis", fig.asp = 1800/2250}
slug <- "TF-Predictions_lambda.1se"
supp_cap(slug)
include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakrate-risks-lse, results = "asis"}
slug <- "Risks-EDSL-Mean_PeakRate-L1SE"
pkrate_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

pkrate_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Peak rate")) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakweek-risks-lse, results = "asis"}
slug <- "Risks-EDSL-Mean_PeakWeek-L1SE"
pkweek_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

pkweek_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Peak week")) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-cumhosp-risks-lse, results = "asis"}
slug <- "Risks-EDSL-Mean_CumHosp-L1SE"
cumhosp_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

cumhosp_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Cumulative hospitalizations")) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakrate-risktiles-lse, results = "asis", fig.asp = 1800/3600}
slug <- "Risktiles_Peak-Rate-L1SE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakweek-risktiles-lse, results = "asis", fig.asp = 1800/3600}
slug <- "Risktiles_Peak-Week-L1SE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-cumhosp-risktiles-lse, results = "asis", fig.asp = 1800/3600}
slug <- "Risktiles_Cum-Hosp-L1SE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakrate-risks-erf, results = "asis"}
slug <- "Risks-EDSL-Mean_PeakRate-ERF"
pkrate_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

pkrate_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Peak rate")) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakweek-risks-erf, results = "asis"}
slug <- "Risks-EDSL-Mean_PeakWeek-ERF"
pkweek_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

pkweek_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Peak week")) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-cumhosp-risks-erf, results = "asis"}
slug <- "Risks-EDSL-Mean_CumHosp-ERF"
cumhosp_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

cumhosp_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Cumulative hospitalizations")) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakrate-risktiles-erf, results = "asis", fig.asp = 1950/3600}
slug <- "Risktiles_Peak-Rate-ERF"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakweek-risktiles-erf, results = "asis", fig.asp = 1950/3600}
slug <- "Risktiles_Peak-Week-ERF"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-cumhosp-risktiles-erf, results = "asis", fig.asp = 1950/3600}
slug <- "Risktiles_Cum-Hosp-ERF"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage


<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakrate-risks-sqe, results = "asis"}
slug <- "Risks-EDSL-Mean_PeakRate-SQE"
pkrate_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

pkrate_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Peak rate", sqe = TRUE)) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-peakweek-risks-sqe, results = "asis"}
slug <- "Risks-EDSL-Mean_PeakWeek-SQE"
pkweek_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

pkweek_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Peak week", sqe = TRUE)) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL TABLE -->

```{r supp-cumhosp-risks-sqe, results = "asis"}
slug <- "Risks-EDSL-Mean_CumHosp-SQE"
cumhosp_risks <- fread(get_asset("TAB", slug))

supp_cap(slug)

cumhosp_risks %>%
  flextable(
    cwidth = c(0.6, rep(1.1, 2))
  ) %>%
  risktab_cnames_word() %>%
  bold(., part = "header") %>%
  add_footer_lines(risktabfn("Cumulative hospitalizations", sqe = TRUE)) %>%
  font(., fontname = global_table_font, part = "all")
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->


```{r fig.id="ensemble-perf-sqe", results = "asis", fig.width = 4.8, fig.asp = 3000/1800}
slug <- "Ensemble-Summary_All-Targets-SQE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", "Ensemble-Summary_All-Targets-SQE"))
```


<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakrate-risktiles-sqe, results = "asis", fig.asp = 1350/3600}
slug <- "Risktiles_Peak-Rate-SQE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-peakweek-risktiles-sqe, results = "asis", fig.asp = 1350/3600}
slug <- "Risktiles_Peak-Week-SQE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```
\newpage

<!-- SUPPLEMENTAL FIGURE -->

```{r supp-cumhosp-risktiles-sqe, results = "asis", fig.asp = 1350/3600}
slug <- "Risktiles_Cum-Hosp-SQE"
supp_cap(slug)
knitr::include_graphics(get_asset("FIG", slug))
```



\newpage
# References

\bibliography{references}
